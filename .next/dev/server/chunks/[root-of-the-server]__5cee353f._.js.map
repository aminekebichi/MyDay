{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/kebichiamine/git_workspace/MyDay/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst prismaClientSingleton = () => {\n    return new PrismaClient()\n}\n\ndeclare const globalThis: {\n    prismaGlobal: ReturnType<typeof prismaClientSingleton>;\n} & typeof global;\n\nconst prisma = globalThis.prismaGlobal ?? prismaClientSingleton()\n\nexport default prisma\n\nif (process.env.NODE_ENV !== 'production') globalThis.prismaGlobal = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,wBAAwB;IAC1B,OAAO,IAAI,sMAAY;AAC3B;AAMA,MAAM,SAAS,WAAW,YAAY,IAAI;uCAE3B;AAEf,wCAA2C,WAAW,YAAY,GAAG"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/kebichiamine/git_workspace/MyDay/src/lib/session.ts"],"sourcesContent":["import prisma from \"./prisma\";\n\nexport async function validateSession(request: Request) {\n    const sessionToken = request.headers.get(\"X-Session-Token\");\n\n    if (!sessionToken) {\n        throw new Error(\"UNAUTHORIZED\");\n    }\n\n    const user = await prisma.user.findUnique({\n        where: { sessionToken },\n    });\n\n    if (!user) {\n        throw new Error(\"UNAUTHORIZED\");\n    }\n\n    return user;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,gBAAgB,OAAgB;IAClD,MAAM,eAAe,QAAQ,OAAO,CAAC,GAAG,CAAC;IAEzC,IAAI,CAAC,cAAc;QACf,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,OAAO,MAAM,iIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACtC,OAAO;YAAE;QAAa;IAC1B;IAEA,IAAI,CAAC,MAAM;QACP,MAAM,IAAI,MAAM;IACpB;IAEA,OAAO;AACX"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///Users/kebichiamine/git_workspace/MyDay/src/lib/validation.ts"],"sourcesContent":["import { z } from \"zod\";\nimport { ItemType, Priority, Recurrence } from \"@prisma/client\";\n\nexport const createItemSchema = z.object({\n    title: z.string().min(1, \"Title is required\"),\n    type: z.nativeEnum(ItemType),\n    priority: z.nativeEnum(Priority),\n    date: z.string().transform((val) => new Date(val)),\n    time: z.string().optional().transform((val) => (val ? new Date(val) : undefined)),\n    recurrence: z.nativeEnum(Recurrence).optional().default(Recurrence.NONE),\n    recurrenceEndDate: z.string().optional().transform((val) => (val ? new Date(val) : undefined)),\n    notes: z.string().optional(),\n    attendeeName: z.string().optional(),\n});\n\nexport const updateItemSchema = createItemSchema.partial().extend({\n    completedAt: z.string().optional().nullable().transform((val) => {\n        if (val === null) return null;\n        return val ? new Date(val) : undefined;\n    }),\n});\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IACrC,OAAO,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACzB,MAAM,oLAAC,CAAC,UAAU,CAAC,kMAAQ;IAC3B,UAAU,oLAAC,CAAC,UAAU,CAAC,kMAAQ;IAC/B,MAAM,oLAAC,CAAC,MAAM,GAAG,SAAS,CAAC,CAAC,MAAQ,IAAI,KAAK;IAC7C,MAAM,oLAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,SAAS,CAAC,CAAC,MAAS,MAAM,IAAI,KAAK,OAAO;IACtE,YAAY,oLAAC,CAAC,UAAU,CAAC,oMAAU,EAAE,QAAQ,GAAG,OAAO,CAAC,oMAAU,CAAC,IAAI;IACvE,mBAAmB,oLAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,SAAS,CAAC,CAAC,MAAS,MAAM,IAAI,KAAK,OAAO;IACnF,OAAO,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC1B,cAAc,oLAAC,CAAC,MAAM,GAAG,QAAQ;AACrC;AAEO,MAAM,mBAAmB,iBAAiB,OAAO,GAAG,MAAM,CAAC;IAC9D,aAAa,oLAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ,GAAG,SAAS,CAAC,CAAC;QACrD,IAAI,QAAQ,MAAM,OAAO;QACzB,OAAO,MAAM,IAAI,KAAK,OAAO;IACjC;AACJ"}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///Users/kebichiamine/git_workspace/MyDay/src/app/api/items/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport prisma from \"@/lib/prisma\";\nimport { validateSession } from \"@/lib/session\";\nimport { createItemSchema } from \"@/lib/validation\";\nimport { startOfDay, endOfDay } from \"date-fns\";\nimport { z } from \"zod\";\n\nexport async function GET(request: Request) {\n    try {\n        const user = await validateSession(request);\n\n        const { searchParams } = new URL(request.url);\n        const dateQuery = searchParams.get(\"date\");\n\n        if (!dateQuery) {\n            return NextResponse.json({ error: \"Missing date parameter\", code: \"BAD_REQUEST\" }, { status: 400 });\n        }\n\n        const targetDate = new Date(dateQuery);\n\n        if (isNaN(targetDate.getTime())) {\n            return NextResponse.json({ error: \"Invalid date format\", code: \"BAD_REQUEST\" }, { status: 400 });\n        }\n\n        // Adjust date boundaries to accommodate potential timezone shifts when SQLite stores UTC dates.\n        const startOfTargetDay = new Date(targetDate);\n        startOfTargetDay.setUTCHours(0, 0, 0, 0);\n        const queryStart = new Date(startOfTargetDay.getTime() - 24 * 60 * 60 * 1000);\n\n        const endOfTargetDay = new Date(targetDate);\n        endOfTargetDay.setUTCHours(23, 59, 59, 999);\n        const queryEnd = new Date(endOfTargetDay.getTime() + 24 * 60 * 60 * 1000);\n\n        const items = await prisma.item.findMany({\n            where: {\n                userId: user.id,\n                date: {\n                    gte: queryStart,\n                    lte: queryEnd,\n                },\n            },\n            orderBy: [\n                { priority: 'desc' },\n                { time: 'asc' },\n            ],\n        });\n\n        // Filter in memory for MVP to avoid SQLite Date quirks\n        // Target date from query (e.g. 2026-02-28)\n        const targetYear = targetDate.getUTCFullYear();\n        const targetMonth = targetDate.getUTCMonth();\n        const targetDay = targetDate.getUTCDate();\n\n        const filteredItems = items.filter((item: any) => {\n            const itemDate = new Date(item.date);\n            return itemDate.getUTCFullYear() === targetYear &&\n                itemDate.getUTCMonth() === targetMonth &&\n                itemDate.getUTCDate() === targetDay;\n        });\n\n        return NextResponse.json(filteredItems);\n    } catch (error) {\n        if (error instanceof Error && error.message === \"UNAUTHORIZED\") {\n            return NextResponse.json({ error: \"Unauthorized\", code: \"UNAUTHORIZED\" }, { status: 401 });\n        }\n        return NextResponse.json({ error: \"Internal Server Error\", code: \"INTERNAL_ERROR\" }, { status: 500 });\n    }\n}\n\nexport async function POST(request: Request) {\n    try {\n        const user = await validateSession(request);\n        const body = await request.json();\n\n        const parsedData = createItemSchema.parse(body);\n\n        const item = await prisma.item.create({\n            data: {\n                ...parsedData,\n                userId: user.id,\n            }\n        });\n\n        return NextResponse.json(item, { status: 201 });\n    } catch (error) {\n        if (error instanceof Error && error.message === \"UNAUTHORIZED\") {\n            return NextResponse.json({ error: \"Unauthorized\", code: \"UNAUTHORIZED\" }, { status: 401 });\n        }\n        if (error instanceof z.ZodError) {\n            return NextResponse.json({ error: \"Validation failed\", code: \"VALIDATION_ERROR\", details: error.flatten().fieldErrors }, { status: 400 });\n        }\n        return NextResponse.json({ error: \"Internal Server Error\", code: \"INTERNAL_ERROR\" }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":"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"}}]
}